<style>
  #click-counter {
    position: absolute;
    top: 10px;
    right: 10px;
    font-family: "Monocraft", monospace;
    font-size: 32px; /* bigger */
    opacity: 0;
    transition: opacity .25s ease;
  }
  #click-counter.show {
    opacity: 1;
  }
</style>

<script>
(() => {
  const frame = document.getElementById('logoBtn');
  const layer = document.getElementById('particleLayer');
  const msg = document.getElementById('easter-egg');
  const counter = document.getElementById('click-counter');
  const reduce = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

  let clicks = 0;
  let firstClickTime = null;
  const showCounterAt = 5;
  const targetClicks = 100;

  function spawnParticles(n = 24) {
    const rect = frame.getBoundingClientRect();
    const isSmall = Math.min(window.innerWidth, window.innerHeight) < 500;
    const count = reduce ? 0 : (isSmall ? Math.ceil(n * 0.5) : n);

    for (let i = 0; i < count; i++) {
      const el = document.createElement('div');
      el.className = 'particle';

      const size = 4 + Math.random() * 8;
      el.style.width = size + 'px';
      el.style.height = size + 'px';

      const startX = Math.random() * rect.width;
      const startY = Math.random() * rect.height * 0.5;

      const endY = rect.height + Math.random() * rect.height * 0.5;
      const endX = startX + (Math.random() - 0.5) * rect.width * 0.3;

      const rotStart = (Math.random() * 90 - 45) + 'deg';
      const rotEnd = (Math.random() * 180 - 90) + 'deg';

      const dur = 900 + Math.random() * 900;

      el.style.left = startX + 'px';
      el.style.top = startY + 'px';

      el.style.setProperty('--x', '0px');
      el.style.setProperty('--y', '0px');
      el.style.setProperty('--xend', (endX - startX) + 'px');
      el.style.setProperty('--yend', (endY - startY) + 'px');
      el.style.setProperty('--rot', rotStart);
      el.style.setProperty('--rotEnd', rotEnd);
      el.style.setProperty('--dur', dur + 'ms');

      layer.appendChild(el);
      el.addEventListener('animationend', () => el.remove());
    }
  }

  function updateCounter() {
    if (clicks >= showCounterAt && !counter.classList.contains('show')) {
      counter.classList.add('show');
    }
    counter.textContent = clicks;

    if (clicks >= targetClicks && firstClickTime) {
      const elapsed = Math.floor((Date.now() - firstClickTime) / 1000);
      msg.textContent = `You wasted ${elapsed} seconds`;
    }
  }

  frame.addEventListener('click', () => {
    if (!firstClickTime) firstClickTime = Date.now();

    frame.classList.remove('wiggle');
    void frame.offsetWidth;
    frame.classList.add('wiggle');

    spawnParticles(24);

    clicks += 1;
    if (clicks >= showCounterAt) msg.classList.add('show');

    updateCounter();
  });

  frame.addEventListener('keydown', (ev) => {
    if (ev.code === 'Space' || ev.code === 'Enter') {
      ev.preventDefault();
      frame.click();
    }
  });
})();
</script>
